<html>
  <head>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-vr-mode-watcher@1.0.0/dist/aframe-vr-mode-watcher.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component/dist/aframe-environment-component.min.js"></script>
  </head>
  <body>
    <a-scene>
      
    	<!-- Camera and Cursor Setup -->
      <a-camera id="cam" position="-10 7 35">
        <a-cursor
          color="white"
          fuse="true"
          rayOrigin="mouse"
          objects=".carrot, #happySnowman"
        ></a-cursor>
      </a-camera>

      <a-entity
        environment="preset: goldmine;
                      playArea:2;
                     seed: 61;
                     skyType: gradient;
                     skyColor: #000000;
                     skyColor2: #e97451;
                     ground: hills;
                     groundYScale: 20;
                     groundColor: #f7f6fa;
                     dressing: none;    
                     
                     "
      >
      </a-entity>
  
		<a-entity
		  gltf-model="models/wintersidewalk.glb"
		  id="sidewalk"
		  position="0 -11 0"
		  rotation="0 0 0"
		  scale="1 1 1"
		></a-entity>

		<a-entity
		  gltf-model="models/Home.glb"
		  id="tavern2"
		  position="12 2 -70"
		  rotation="0 180 0"
		  scale=".02 .02 .02"
		  animation-mixer
		></a-entity>

		<a-entity
		  gltf-model="models/winterhouse alt.glb"
		  id="home2"
		  position="10 1 -30"
		  rotation="0 0 0"
		  scale="3 3 3"
		  animation-mixer
		></a-entity>

		<a-entity
		  gltf-model="models/winterhouse alt.glb"
		  id="neighbor2"
		  position="60 2 -50"
		  rotation="0 -90 0"
		  scale="3 3 3"
		  animation-mixer
		></a-entity>

		<a-entity
		  gltf-model="models/snow scene.glb"
		  id="snow2"
		  position="-10 1 -30"
		  rotation="0 0 0"
		  scale="10 10 10"
		  animation-mixer
		></a-entity>

		<a-entity
		  gltf-model="models/WinterVillage.glb"
		  id="village2"
		  position="-40 -5 -40"
		  rotation="0 -5 0"
		  scale="5 5 5"
		  animation-mixer
		></a-entity>

		<a-entity
		  gltf-model="models/streetlight.glb"
		  id="streetlamp"
		  position="-10 -2 -20"
		  rotation="0 -90 0"
		  scale="4 4 4"
		></a-entity>

		<a-entity
		  gltf-model="models/lighttest.glb"
		  id="ringlight2"
		  position="20 1 -18"
		  rotation="0 -90 0"
		  scale="1 1 1"
		  animation-mixer
		></a-entity>

		<!-- Hangry Snowman (initially 3 times bigger)-->
	<a-gltf-model
	  id="hangrySnowman"
	  position="0 0 -5"
	  rotation="0 0 0"
	  scale="3 3 3"
	  src="models/hangrysnowman.glb"
	></a-gltf-model>

	<!-- Happy Snowman (initially hidden) -->
	<a-gltf-model
	  id="happySnowman"
	  position="0 0 -5"
	  rotation="0 0 0"
	  scale="1 1 1"
	  src="models/happysnowman.glb"
	  visible="false"
	></a-gltf-model>

	<!-- Carrots (you can add multiple carrots) -->
	<a-gltf-model
	  class="carrot"
	  position="2 0 -5"
	  rotation="0 0 0"
	  scale="0.1 0.1 0.1"
	  src="models/carrot.glb"
	></a-gltf-model>

	<!-- Animation for hangry snowman shrinking -->
	      <a-animation
	        attribute="scale"
	        begin="shrinkSnowman"
	        from="3 3 3"
	        to="1 1 1"
	        dur="1000"
	        fill="forwards"
	        repeat="0"
	      ></a-animation>


	    <!-- JavaScript for carrot collection and snowman transformation -->
	      <script>
	        let carrotCount = 0; // Initialize the carrot count

	        // Function to handle carrot collection
	        function collectCarrot() {
	          carrotCount++; // Increment the carrot count
	          if (carrotCount === 3) {
	            // If the player collects 3 carrots
	            document.querySelector("#hangrySnowman").emit("shrinkSnowman"); // Emit the animation event
	            document.querySelector("#happySnowman").setAttribute("visible", "true"); // Show the happy snowman
	          }
	        }

	        // Add event listeners for carrot collection
	        const carrots = document.querySelectorAll(".carrot");
	        carrots.forEach((carrot) => {
	          carrot.addEventListener("click", () => {
	            collectCarrot();
	            carrot.setAttribute("visible", "false"); // Hide the collected carrot
	          });
	        });
	      </script>
	    </a-scene>
  </body>
</html>
